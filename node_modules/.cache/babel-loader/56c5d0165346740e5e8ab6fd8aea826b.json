{"ast":null,"code":"var _jsxFileName = \"/home/jl/skript/gosh/roommanager/front-end/src/components/adminpannel.jsx\";\nimport React, { Component } from \"react\";\nimport { Accordion, Row, Card, Button, Col } from \"react-bootstrap\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass adminPanel extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      perms: null,\n      users: null,\n      limit: 10,\n      page: 0,\n      editusers: null,\n      editing: false\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(React.Fragment, {\n      children: !this.state.users ? /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"still loading\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(React.Fragment, {\n        children: [this.renderusers(), this.renderButton()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 23,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 7\n    }, this);\n  }\n\n  renderusers() {\n    return /*#__PURE__*/_jsxDEV(Accordion, {\n      children: this.state.editusers.map((user, i) => {\n        return /*#__PURE__*/_jsxDEV(Card, {\n          children: [/*#__PURE__*/_jsxDEV(Card.Header, {\n            children: /*#__PURE__*/_jsxDEV(Accordion.Toggle, {\n              as: Button,\n              variant: \"link\",\n              eventKey: i.toString(),\n              children: user.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 40,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 39,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Accordion.Collapse, {\n            eventKey: i.toString(),\n            children: /*#__PURE__*/_jsxDEV(Card.Body, {\n              children: Object.keys(user.perms).map((per, j) => {\n                return /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: per\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 53,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(Button, {\n                      disabled: !this.state.editing,\n                      variant: !user.perms[per] ? \"danger\" : \"success\",\n                      onClick: e => {\n                        this.setState(prevState => {\n                          prevState[\"editusers\"][i][\"perms\"][per] = !user.perms[per];\n                          return prevState;\n                        });\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 55,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 54,\n                    columnNumber: 25\n                  }, this)]\n                }, j, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 52,\n                  columnNumber: 23\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 49,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 48,\n            columnNumber: 15\n          }, this)]\n        }, user._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 7\n    }, this);\n  }\n\n  async getusers() {\n    const url = \"/api/users/all/admin\";\n    const result = await fetch(url);\n    const data = await result.json();\n    var d1 = JSON.parse(JSON.stringify(data));\n    var d2 = JSON.parse(JSON.stringify(data));\n    console.log(data);\n    this.setState({\n      users: d1,\n      editusers: d2\n    });\n  }\n\n  async componentDidMount() {\n    const perm = await fetch(\"/api/users/me/auth\");\n    const fine2 = await perm.json();\n    this.setState({\n      perms: fine2\n    });\n    await this.getusers();\n  }\n\n  renderButton() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: !this.state.editing ? /*#__PURE__*/_jsxDEV(Button, {\n        onClick: () => this.setState({\n          editing: true\n        }),\n        children: \"edit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => this.setState({\n            editing: false\n          }),\n          children: \"cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"danger\",\n          onClick: e => this.doadvancedstuff(),\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this);\n  }\n\n  async doadvancedstuff() {\n    const a = this.state.editusers.filter((a, i) => {\n      return JSON.stringify(this.state.users[i]) !== JSON.stringify(a);\n    });\n    var myHeaders = new Headers();\n    myHeaders.append(\"Content-Type\", \"application/json\");\n    var raw = JSON.stringify(a);\n    var requestOptions = {\n      method: \"PATCH\",\n      headers: myHeaders,\n      body: raw,\n      redirect: \"follow\"\n    };\n    fetch(\"/api/users/update/admin\", requestOptions);\n    this.setState({\n      users: JSON.parse(JSON.stringify(this.state.editusers))\n    });\n  }\n\n}\n\nexport default adminPanel;","map":{"version":3,"sources":["/home/jl/skript/gosh/roommanager/front-end/src/components/adminpannel.jsx"],"names":["React","Component","Accordion","Row","Card","Button","Col","adminPanel","constructor","props","state","perms","users","limit","page","editusers","editing","render","renderusers","renderButton","map","user","i","toString","name","Object","keys","per","j","e","setState","prevState","_id","getusers","url","result","fetch","data","json","d1","JSON","parse","stringify","d2","console","log","componentDidMount","perm","fine2","doadvancedstuff","a","filter","myHeaders","Headers","append","raw","requestOptions","method","headers","body","redirect"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Accordion, Row, Card, Button, Col } from \"react-bootstrap\";\n\nclass adminPanel extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      perms: null,\n      users: null,\n      limit: 10,\n      page: 0,\n      editusers: null,\n      editing: false,\n    };\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        {!this.state.users ? (\n          <h1>still loading</h1>\n        ) : (\n          <React.Fragment>\n            {this.renderusers()}\n\n            {this.renderButton()}\n          </React.Fragment>\n        )}\n      </React.Fragment>\n    );\n  }\n\n  renderusers() {\n    return (\n      <Accordion>\n        {this.state.editusers.map((user, i) => {\n          return (\n            <Card key={user._id}>\n              <Card.Header>\n                <Accordion.Toggle\n                  as={Button}\n                  variant=\"link\"\n                  eventKey={i.toString()}\n                >\n                  {user.name}\n                </Accordion.Toggle>\n              </Card.Header>\n              <Accordion.Collapse eventKey={i.toString()}>\n                <Card.Body>\n                  {Object.keys(user.perms).map((per, j) => {\n                    return (\n                      <Row key={j}>\n                        <Col>{per}</Col>\n                        <Col>\n                          <Button\n                            disabled={!this.state.editing}\n                            variant={!user.perms[per] ? \"danger\" : \"success\"}\n                            onClick={(e) => {\n                              this.setState((prevState) => {\n                                prevState[\"editusers\"][i][\"perms\"][per] =\n                                  !user.perms[per];\n\n                                return prevState;\n                              });\n                            }}\n                          ></Button>\n                        </Col>\n                      </Row>\n                    );\n                  })}\n                </Card.Body>\n              </Accordion.Collapse>\n            </Card>\n          );\n        })}\n      </Accordion>\n    );\n  }\n\n  async getusers() {\n    const url = \"/api/users/all/admin\";\n\n    const result = await fetch(url);\n    const data = await result.json();\n\n    var d1 = JSON.parse(JSON.stringify(data));\n    var d2 = JSON.parse(JSON.stringify(data));\n    console.log(data);\n    this.setState({ users: d1, editusers: d2 });\n  }\n\n  async componentDidMount() {\n    const perm = await fetch(\"/api/users/me/auth\");\n    const fine2 = await perm.json();\n\n    this.setState({\n      perms: fine2,\n    });\n    await this.getusers();\n  }\n  renderButton() {\n    return (\n      <div>\n        {!this.state.editing ? (\n          <Button onClick={() => this.setState({ editing: true })}>edit</Button>\n        ) : (\n          <Row>\n            <Button onClick={() => this.setState({ editing: false })}>\n              cancel\n            </Button>\n            <Button variant=\"danger\" onClick={(e) => this.doadvancedstuff()}>\n              Save\n            </Button>\n          </Row>\n        )}\n      </div>\n    );\n  }\n\n  async doadvancedstuff() {\n    const a = this.state.editusers.filter((a, i) => {\n      return JSON.stringify(this.state.users[i]) !== JSON.stringify(a);\n    });\n\n    var myHeaders = new Headers();\n    myHeaders.append(\"Content-Type\", \"application/json\");\n\n    var raw = JSON.stringify(a);\n\n    var requestOptions = {\n      method: \"PATCH\",\n      headers: myHeaders,\n      body: raw,\n      redirect: \"follow\",\n    };\n\n    fetch(\"/api/users/update/admin\", requestOptions);\n    this.setState({ users: JSON.parse(JSON.stringify(this.state.editusers)) });\n  }\n}\n\nexport default adminPanel;\n"]},"metadata":{},"sourceType":"module"}